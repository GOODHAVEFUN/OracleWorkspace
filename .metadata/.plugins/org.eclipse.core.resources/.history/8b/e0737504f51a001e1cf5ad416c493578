-- 1. 축구 선수들 중에서 각 팀별로 키가 가장 큰 선수들의 전체 정보 조회

-- 위 문제를 JOIN 없이 풀기
-- (A, B) IN (C, D) : A = C AND B = D

SELECT P.*
FROM PLAYER P
WHERE (P.TEAM_ID, P.HEIGHT) IN (
  SELECT TEAM_ID, MAX(HEIGHT)
  FROM PLAYER
  GROUP BY TEAM_ID
);

-- 2. EMPLOYEES 테이블의 각 사원의 매니저의 직무 조회
SELECT E.FIRST_NAME, E.LAST_NAME, J.JOB_TITLE
FROM EMPLOYEES E
JOIN EMPLOYEES M ON E.MANAGER_ID = M.EMPLOYEE_ID
JOIN JOBS J ON M.JOB_ID = J.JOB_ID;

-- 3. EMPLOYEES 테이블의 모든 사원의 이름과 부서명 조회
SELECT E.FIRST_NAME, E.LAST_NAME, D.DEPARTMENT_NAME
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID;

-- 4. EMPLOYEES 테이블에서 매니저가 없는 사원의 이름과 직무 조회
SELECT E.FIRST_NAME, E.LAST_NAME, D.DEPARTMENT_NAME
FROM EMPLOYEES e 
JOIN DEPARTMENTS d ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
WHERE E.MANAGER_ID IS NULL;

-- 5. EMPLOYEES 테이블에서 직무별 평균 급여 조회
SELECT J.JOB_TITLE, AVG(E.SALARY)
FROM EMPLOYEES E, JOBS J
WHERE E.JOB_ID = J.JOB_ID
GROUP BY J.JOB_TITLE;

-- 6. EMPLOYEES 테이블에서 매니저별로 직속 직원 사원수 조회
SELECT M.FIRST_NAME, M.LAST_NAME, 
COUNT(E.EMPLOYEE_ID)
FROM EMPLOYEES E, EMPLOYEES M
WHERE E.MANAGER_ID = M.EMPLOYEE_ID
GROUP BY M.FIRST_NAME, M.LAST_NAME;